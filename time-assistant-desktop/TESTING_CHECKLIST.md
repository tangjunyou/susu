# 测试验证清单

## 编译前检查

### 环境检查
```bash
# 检查Rust版本
rustc --version  # 应该 >= 1.70.0

# 检查Cargo版本
cargo --version

# 检查Node.js版本
node --version  # 应该 >= 18.0.0

# 检查pnpm
pnpm --version
```

### 依赖安装
```bash
cd time-assistant-desktop
pnpm install
```

预期输出：无错误，所有依赖成功安装

## 编译测试

### 步骤1：清理构建
```bash
cd src-tauri
cargo clean
```

### 步骤2：检查语法
```bash
cargo check
```

**预期：** 无错误，可能有警告（unused imports等）

**常见问题：**
- 缺少依赖：运行 `cargo update`
- 系统库缺失：安装对应系统依赖

### 步骤3：开发构建
```bash
cd ..
pnpm tauri dev
```

**预期：**
- 编译时间：5-15分钟（首次）
- 应用窗口出现
- 无致命错误

**检查点：**
- [ ] 应用窗口正常显示
- [ ] 界面UI渲染正确
- [ ] 无控制台错误

## 功能测试

### A. 核心功能

#### 1. 窗口置顶
- [ ] 打开设置面板
- [ ] 启用"窗口置顶"
- [ ] 打开其他应用窗口
- [ ] 验证时间助手始终在最上层
- [ ] 关闭置顶，验证窗口恢复正常层级

#### 2. 计划管理
- [ ] 点击"添加计划"
- [ ] 填写标题："测试计划1"
- [ ] 选择优先级：高
- [ ] 选择分类：工作
- [ ] 点击添加
- [ ] 验证计划卡片出现
- [ ] 点击完成按钮，验证状态变化
- [ ] 点击删除，验证计划移除

#### 3. 时间跟踪
- [ ] 创建新计划
- [ ] 点击"开始计时"
- [ ] 等待10秒
- [ ] 验证时间累加
- [ ] 点击"停止计时"
- [ ] 关闭并重新打开应用
- [ ] 验证时间已保存

#### 4. 反思记录
- [ ] 为计划添加反思
- [ ] 输入内容："这是测试反思"
- [ ] 保存
- [ ] 验证反思显示在列表中
- [ ] 删除反思
- [ ] 验证反思已移除

### B. 数据持久化

#### 1. 数据保存
- [ ] 添加3个不同的计划
- [ ] 完全关闭应用
- [ ] 重新打开
- [ ] 验证所有计划都存在

#### 2. 数据位置
检查数据库文件是否存在：

**Windows:**
```powershell
dir %APPDATA%\time-assistant\data.db
```

**macOS:**
```bash
ls ~/Library/Application\ Support/time-assistant/data.db
```

**Linux:**
```bash
ls ~/.local/share/time-assistant/data.db
```

### C. 系统集成

#### 1. 系统托盘
- [ ] 点击关闭按钮
- [ ] 验证窗口隐藏（不退出）
- [ ] 查看系统托盘有图标
- [ ] 点击托盘图标
- [ ] 验证窗口显示
- [ ] 右键托盘图标
- [ ] 验证菜单显示

#### 2. 开机自启（新功能）
- [ ] 打开设置
- [ ] 启用"开机自启"
- [ ] 重启系统
- [ ] 验证应用自动启动

**如失败：** 检查系统权限设置

#### 3. 全局快捷键（新功能）
- [ ] 应用在前台
- [ ] 按 Ctrl+Shift+T (macOS: Cmd+Shift+T)
- [ ] 验证窗口隐藏
- [ ] 再按一次
- [ ] 验证窗口显示

**如失败：** 可能与其他应用快捷键冲突

#### 4. 系统通知（新功能）
这个功能需要在代码中调用，可以添加测试按钮：

```typescript
import { notificationApi } from '../utils/api';

// 测试通知
await notificationApi.sendNotification(
  '测试通知',
  '这是一条测试消息'
);
```

### D. UI/UX测试

#### 1. 主题切换
- [ ] 切换到深色模式
- [ ] 验证所有组件颜色正确
- [ ] 切换回浅色模式
- [ ] 关闭重开应用
- [ ] 验证主题设置保留

#### 2. 响应式
- [ ] 调整窗口大小到最小
- [ ] 验证UI不破碎
- [ ] 调整到最大
- [ ] 验证布局正常

#### 3. 筛选功能
- [ ] 创建已完成和未完成的计划
- [ ] 筛选"进行中"
- [ ] 验证只显示未完成的
- [ ] 筛选"已完成"
- [ ] 验证只显示已完成的

### E. 数据导出

#### 1. 导出功能
- [ ] 打开设置
- [ ] 点击"导出数据"
- [ ] 选择保存位置
- [ ] 验证JSON文件生成
- [ ] 打开文件验证内容格式正确

## 性能测试

### 1. 内存占用
```bash
# Linux/macOS
ps aux | grep time-assistant

# Windows任务管理器
```

**预期：** < 100MB

### 2. 启动速度
测量从点击到窗口显示的时间

**预期：** < 3秒

### 3. 响应速度
- [ ] 添加计划响应时间 < 100ms
- [ ] 切换主题立即响应
- [ ] 滚动流畅无卡顿

## 错误处理测试

### 1. 非法输入
- [ ] 提交空标题计划
- [ ] 验证阻止提交

### 2. 删除确认
- [ ] 删除计划时弹出确认
- [ ] 删除反思时弹出确认

## 跨平台测试

如可能，在三个平台测试：

### Windows
- [ ] 编译成功
- [ ] 所有功能正常
- [ ] 托盘图标显示
- [ ] .exe可独立运行

### macOS
- [ ] 编译成功
- [ ] 所有功能正常
- [ ] 托盘图标显示
- [ ] .app可独立运行

### Linux
- [ ] 编译成功
- [ ] 所有功能正常
- [ ] 托盘图标显示
- [ ] AppImage可运行

## 问题记录

测试中发现的问题请记录：

| 序号 | 功能 | 问题描述 | 严重性 | 状态 |
|------|------|----------|--------|------|
| 1    |      |          |        |      |
| 2    |      |          |        |      |

严重性级别：
- P0：阻塞发布
- P1：重要，需修复
- P2：次要，可延后
- P3：优化建议

## 测试通过标准

最低要求（可发布）：
- [x] 编译无错误
- [x] 核心功能（A部分）全部通过
- [x] 数据持久化正常
- [x] 无P0/P1级别问题

理想标准：
- [ ] 所有测试项通过
- [ ] 三个平台都测试
- [ ] 无已知bug
- [ ] 性能达标

---

**测试建议：**
1. 优先测试核心功能
2. 发现问题立即修复
3. 重新测试受影响的部分
4. 记录所有问题和解决方案
